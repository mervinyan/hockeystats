extends layout

block links

    <!-- C3 Chart CSS -->
    link(href='/bower_components/c3/c3.css' rel='stylesheet' type='text/css')
    
    link(href="/stylesheets/style.css" rel="stylesheet" type="text/css")
    
    <!-- Bootstrap Core CSS -->
    link(href="/bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css")

    <!-- MetisMenu CSS -->
    link(href="/bower_components/metisMenu/dist/metisMenu.min.css" rel="stylesheet" type="text/css")

    <!-- DataTables CSS -->
    link(href="/bower_components/datatables-plugins/integration/bootstrap/3/dataTables.bootstrap.css" rel="stylesheet" type="text/css")

    <!-- DataTables Responsive CSS -->
    link(href="bower_components/datatables-responsive/css/responsive.dataTables.scss" rel="stylesheet")
    
    <!-- Custom CSS -->
    link(href="/bower_components/sb-admin-2/css/sb-admin-2.css" rel="stylesheet" type="text/css")

    <!-- Custom Fonts -->
    link(href="/bower_components/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css")

block content
    div.row
        div.col-lg-12
            h1.page-header #{title}
            ol.breadcrumb
                li
                    i.fa.fa-dashboard
                    a(href="/") 
                        | Dashboard
                li
                    i.fa.fa-users
                        | 
                        | Team Stats
    div.row
        div.col-lg-12
            div.panel.panel-default
                div.panel-heading
                    | Game Stats
                div.panel-body
                    div.dataTable_wrapper
                        table#datatable-gamestats.table.table-hover
                            thead
                                tr
                                    th Date
                                    th Time
                                    th Opponent
                                    th Home/Away
                                    th Type
                                    th Rink
                                    th Goals For
                                    th Goals Against
                                    th Penalty in Minutes
                            tbody
                                each game in data.games
                                    tr
                                        td #{game.date}
                                        td #{game.time}
                                        td #{game.opponent}
                                        td #{game.homeaway}
                                        td #{game.kind}
                                        td #{game.rink}
                                        td #{game.gf}
                                        td #{game.ga}
                                        td #{game.pim}
            div.row
                div.col-lg-12
                    div.panel.panel-primary
                        div.panel-heading
                            h3.panel-title 
                                i.fa.fa-bar-chart-o 
                                    | Goals For, Goals Against, Penalty in Minutes By Date
                                div.pull-right
                                    div.btn-group
                                        button#ddl1.btn.btn-default.btn-xs.dropdown-toggle(type="button" data-toggle="dropdown")
                                            | Bar 
                                            span.caret
                                        ul.dropdown-menu.pull-right(role="menu")
                                            li
                                                a()
                                                    | Bar
                                            li
                                                a()
                                                    | TimeSeries                                      
                        div.panel-body
                            div(id='chart00' class='c3chart') 
                            div(id='chart10' class='c3chart')                                      
            div.row
                div.col-lg-12
                    div.panel.panel-primary
                        div.panel-heading
                            h3.panel-title 
                                i.fa.fa-area-chart 
                                    | Goals For, Goals Against, Penalties By Period
                        div.panel-body       
                            div(id='chart20' class='c3chart') 
            div.row
                div.col-lg-12
                    div.panel.panel-primary
                        div.panel-heading
                            h3.panel-title 
                                i.fa.fa-bar-chart-o 
                                    | Goals For, Goals Against, Penalty in Minutes By Opponent
                                div.pull-right
                                    div.btn-group
                                        button#ddl2.btn.btn-default.btn-xs.dropdown-toggle(type="button" data-toggle="dropdown")
                                            | Bar 
                                            span.caret
                                        ul.dropdown-menu.pull-right(role="menu")
                                            li
                                                a()
                                                    | Bar
                                            li
                                                a()
                                                    | Grid                                      
                        div.panel-body
                            div(id='chart30' class='c3chart')
                            div#div30.dataTable_wrapper
                                table#datatable-opponentstats.table.table-hover
                                    thead
                                        tr
                                            th Opponent
                                            th Game Played
                                            th Goals For
                                            th Goals Against
                                            th Penalty in Minutes
                                            th Win
                                            th Loss
                                            th Tie                                            
                                    tbody
                                        each stats in opponent_stats
                                            tr
                                                td #{stats.opponent}
                                                td #{stats.gp}
                                                td #{stats.gf}
                                                td #{stats.ga}
                                                td #{stats.pim}
                                                td #{stats.w}
                                                td #{stats.l}
                                                td #{stats.t}
            div.row
                div.col-lg-12
                    div.panel.panel-primary
                        div.panel-heading
                            h3.panel-title 
                                i.fa.fa-bar-chart-o 
                                    | Goals For, Goals Against, Penalty in Minutes By Rink
                                div.pull-right
                                    div.btn-group
                                        button#ddl3.btn.btn-default.btn-xs.dropdown-toggle(type="button" data-toggle="dropdown")
                                            | Bar 
                                            span.caret
                                        ul.dropdown-menu.pull-right(role="menu")
                                            li
                                                a()
                                                    | Bar
                                            li
                                                a()
                                                    | Grid                                      
                        div.panel-body
                            div(id='chart40' class='c3chart') 
                            div#div40.dataTable_wrapper
                                table#datatable-rinkstats.table.table-hover
                                    thead
                                        tr
                                            th Opponent
                                            th Game Played
                                            th Goals For
                                            th Goals Against
                                            th Penalty in Minutes
                                            th Win
                                            th Loss
                                            th Tie                                            
                                    tbody
                                        each stats in rink_stats
                                            tr
                                                td #{stats.rink}
                                                td #{stats.gp}
                                                td #{stats.gf}
                                                td #{stats.ga}
                                                td #{stats.pim}
                                                td #{stats.w}
                                                td #{stats.l}
                                                td #{stats.t}
                            
            div.row
                div.col-lg-4
                    div.panel.panel-green
                        div.panel-heading
                            h3.panel-title 
                                i.fa.fa-pie-chart 
                                    | Goals By Period   
                        div.panel-body       
                            div(id='chart50' class='c3chart') 
                div.col-lg-8
                    div.panel.panel-green
                        div.panel-heading
                            h3.panel-title 
                                i.fa.fa-pie-chart 
                                    | Goals By Kind   
                        div.panel-body                
                            div(id='chart51' class='c3chart') 
            div.row
                div.col-lg-4     
                    div.panel.panel-green
                        div.panel-heading
                            h3.panel-title 
                                i.fa.fa-pie-chart 
                                    | Penalties By Period   
                        div.panel-body                       
                            div(id='chart60' class='c3chart') 
                div.col-lg-8 
                    div.panel.panel-green
                        div.panel-heading
                            h3.panel-title 
                                i.fa.fa-pie-chart 
                                    | Penalties By Kind   
                        div.panel-body                          
                            div(id='chart61' class='c3chart') 
            div.row
                div.col-lg-4
                    div.panel.panel-green
                        div.panel-heading
                            h3.panel-title 
                                i.fa.fa-pie-chart 
                                    | Penalty In Minutes By Period   
                        div.panel-body               
                            div(id='chart70' class='c3chart') 
                div.col-lg-8                                                         
                    div.panel.panel-green
                        div.panel-heading
                            h3.panel-title 
                                i.fa.fa-pie-chart 
                                    | Penalty In Minutes By Kind   
                        div.panel-body                    
                            div(id='chart71' class='c3chart') 

block scripts
    <!-- D3 Chart JavaScript -->
    script(src='/bower_components/d3/d3.min.js' charset='utf-8' type='text/javascript')

    <!-- C3 Chart JavaScript -->
    script(src='/bower_components/c3/c3.min.js' type='text/javascript')

    <!-- jQuery -->
    script(src="/bower_components/jquery/dist/jquery.min.js" type="text/javascript")
    
    <!-- Bootstrap Core JavaScript -->
    script(src="/bower_components/bootstrap/dist/js/bootstrap.min.js" type="text/javascript")

    <!-- Metis Menu Plugin JavaScript -->
    script(src="/bower_components/metisMenu/dist/metisMenu.min.js" type="text/javascript")

    <!-- DataTables JavaScript -->
    script(src="/bower_components/datatables/media/js/jquery.dataTables.min.js" type="text/javascript")
    script(src="/bower_components/datatables-plugins/integration/bootstrap/3/dataTables.bootstrap.min.js" type="text/javascript")

    <!-- Custom Theme JavaScript -->
    script(src="/bower_components/sb-admin-2/js/sb-admin-2.js" type="text/javascript")
    
    script(type="text/javascript").
        $(document).ready(function() {
            $('#datatable-gamestats').DataTable({
                "responsive": true,
                "bPaginate": true,
                "bJQueryUI": true,
                "bLengthChange": false,
                "bFilter": false,
                "bSort": false,
                "bInfo": true,
                "bAutoWidth": true,
                "bProcessing": true,
                "iDisplayLength": 10,
            });
            $("#chart10").hide();
            $("#div30").hide();
            $("#div40").hide();
        });

        $(".dropdown-menu li a").click(function(){
            var selText = $(this).text();
            $(this).parents('.btn-group').find('.dropdown-toggle').html(selText+' <span class="caret"></span>');
            var id =  $(this).parents('.btn-group').find('.dropdown-toggle').attr('id');
            if (selText == "Bar") {
                if (id == "ddl1") {
                    $("#chart00").show();
                    $("#chart10").hide();
                } else if (id == "ddl2") {
                    $("#chart30").show();
                    $("#div30").hide();
                } else if (id == "ddl3") {
                    $("#chart40").show();
                    $("#div40").hide();
                }
            } else {
                if (id == "ddl1") {
                    $("#chart00").hide();
                    $("#chart10").show();
                } else if (id == "ddl2") {
                    $("#chart30").hide();
                    $("#div30").show();
                } else if (id == "ddl3") {
                    $("#chart40").hide();
                    $("#div40").show();
                }
            }
        });

        c3.generate({
            bindto: '#chart00',
            data: {
                json: !{JSON.stringify(data.games)},
                keys: {
                    x: 'date',
                    value: ['gf', 'ga', 'pim'],
                },
                type: 'bar'
            },
            legend: {
                position: 'inset',
                inset: {
                    anchor: 'top-right'
                }
            },
            axis: {
                x: {
                    type: 'category',
                }
            }
        }); 

        c3.generate({
            bindto: '#chart10',
            data: {
                json: !{JSON.stringify(data.games)},
                keys: {
                    x: 'date',
                    value: ['gf', 'ga', 'pim'],
                }
            },
            legend: {
                position: 'inset',
                inset: {
                    anchor: 'top-right'
                }
            },                        
            axis: {
                x: {
                    type: 'timeseries',
                    tick: {
                        format: '%Y-%m-%d'
                    }
                }
            }
        });

        c3.generate({
            bindto: '#chart20',
            data: {
                json: !{JSON.stringify(data.events)},
                keys: {
                    x:'time',
                    value: ['gf', 'ga', 'penalty'],
                },
                type: 'scatter',
                xFormat: '%M:%S'
            },
            legend: {
                position: 'bottom'
            },                            
            axis: {
                x: {
                    label:'Time',
                    type: 'timeseries',
                    tick: {
                        format: '%M:%S'
                    }
                }
            },
            regions: [
                {axis: 'x', start: '0:00', end: '20:00', class: 'region-period1'},
                {axis: 'x', start: '20:01', end: '40:00', class: 'region-period2'},
                {axis: 'x', start: '40:01', end: '60:00', class: 'region-period3'},
            ],
            tooltip: {
                format: {
                    title: function(d) {
                        var format = d3.time.format('%M:%S');
                        return 'At ' + format(d);
                    },
                    name: function(name, ratio, id, index) {
                        return name;
                    },
                    value: function(value, ratio, id) {
                        if (id == 'gf') {
                            return 'Goal scored by player #' + value;
                        } else if (id == 'ga') {
                            return 'Opponent Goal scored by player #' + value;
                        } else if (id == 'penalty') {
                            return 'Penalty taken by player #' + value;
                        } else {
                            return '';
                        }
                    }                        
                }
            }
        });  
        
        c3.generate({
            bindto: '#chart30',
            data: {
                json: !{JSON.stringify(opponent_stats)},
                keys: {
                    x: 'opponent',
                    value: ['gp', 'gf', 'ga', 'pim', 'w', 'l', 't'],
                },
                type: 'bar'
            },
            legend: {
                position: 'inset',
                inset: {
                    anchor: 'top-right'
                }
            },
            axis: {
                x: {
                    type: 'category',
                }
            }
        }); 

        c3.generate({
            bindto: '#chart40',
            data: {
                json: !{JSON.stringify(rink_stats)},
                keys: {
                    x: 'rink',
                    value: ['gp', 'gf', 'ga', 'pim', 'w', 'l', 't'],
                },
                type: 'bar'
            },
            legend: {
                position: 'inset',
                inset: {
                    anchor: 'top-right'
                }
            },
            axis: {
                x: {
                    type: 'category',
                }
            }
        }); 
    
        c3.generate({
            bindto: '#chart50',
            size: {
                height: 240,
                width: 240
            },
            data: {
                json: !{JSON.stringify(data.goal_by_period)},
                type: 'pie',
            },
            pie: {
                label: {
                    format: function(value, ration, id) {
                        return value;
                    }
                }
            }
        });              

        c3.generate({
            bindto: '#chart51',
            size: {
                height: 240,
                width: 480
            },
            data: {
                json: !{JSON.stringify(data.goal_by_kind)},
                type: 'pie',
            },
            legend: {
                position: 'right'  
            },    
            pie: {
                label: {
                    format: function(value, ration, id) {
                        return value;
                    }
                }
            }
        });
    
        c3.generate({
            bindto: '#chart60',
            size: {
                height: 240,
                width: 240
                },
                data: {
                    json: !{JSON.stringify(data.penalty_by_period)},
                    type: 'pie',
                },                          
                pie: {
                    label: {
                        format: function(value, ration, id) {
                            return value;
                        }
                    }
                }
            });    

        c3.generate({
            bindto: '#chart61',
            size: {
                height: 240,
                width: 480
            },
            data: {
                json: !{JSON.stringify(data.penalty_by_kind)},
                type: 'pie',
            },
            legend: {
                position: 'right'  
            },
            pie: {
                label: {
                    format: function(value, ration, id) {
                        return value;
                    }
                }
            }
        });

        c3.generate({
            bindto: '#chart70',
            size: {
                height: 240,
                width: 240
            },
            data: {
                json: !{JSON.stringify(data.pim_by_period)},
                type: 'pie',
            },                     
            pie: {
                label: {
                    format: function(value, ration, id) {
                        return value;
                    }
                }
            }
        });                  

        c3.generate({
            bindto: '#chart71',
            size: {
                height: 240,
                width: 480
            },
            data: {
                json: !{JSON.stringify(data.pim_by_kind)},
                type: 'pie',
            },
            legend: {
                position: 'right'  
            },
            pie: {
                label: {
                    format: function(value, ration, id) {
                        return value;
                    }
                }
            }
        });     
  
    